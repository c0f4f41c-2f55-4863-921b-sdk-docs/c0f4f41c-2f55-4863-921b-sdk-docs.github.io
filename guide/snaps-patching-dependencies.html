<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Patching Dependencies | MetaMask Docs</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/metamask-fox.svg">
    <link rel="manifest" href="/manifest.json">
    <script data-domain="docs.metamask.io" src="https://plausible.io/js/plausible.js"></script>
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="Developer documentation for the MetaMask Ethereum wallet">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    <link rel="preload" href="/assets/css/0.styles.29ddec2e.css" as="style"><link rel="preload" href="/assets/js/app.4586a63c.js" as="script"><link rel="preload" href="/assets/js/4.7d26e848.js" as="script"><link rel="preload" href="/assets/js/51.4cd0339e.js" as="script"><link rel="preload" href="/assets/js/8.29467d76.js" as="script"><link rel="prefetch" href="/assets/js/10.70580d54.js"><link rel="prefetch" href="/assets/js/11.3f84195b.js"><link rel="prefetch" href="/assets/js/12.a0264f1d.js"><link rel="prefetch" href="/assets/js/13.4f3209c4.js"><link rel="prefetch" href="/assets/js/14.99cba7b1.js"><link rel="prefetch" href="/assets/js/15.c025855f.js"><link rel="prefetch" href="/assets/js/16.e8db1a57.js"><link rel="prefetch" href="/assets/js/17.a3d9e177.js"><link rel="prefetch" href="/assets/js/18.298b7f8c.js"><link rel="prefetch" href="/assets/js/19.41550a32.js"><link rel="prefetch" href="/assets/js/20.dc4a55b7.js"><link rel="prefetch" href="/assets/js/21.63a40cb6.js"><link rel="prefetch" href="/assets/js/22.c1de6add.js"><link rel="prefetch" href="/assets/js/23.3ff51f90.js"><link rel="prefetch" href="/assets/js/24.098ad2f0.js"><link rel="prefetch" href="/assets/js/25.5b2af8d0.js"><link rel="prefetch" href="/assets/js/26.2698fc8f.js"><link rel="prefetch" href="/assets/js/27.7f5f181f.js"><link rel="prefetch" href="/assets/js/28.ba53d2e6.js"><link rel="prefetch" href="/assets/js/29.4458dcec.js"><link rel="prefetch" href="/assets/js/30.9a12cb36.js"><link rel="prefetch" href="/assets/js/31.3c2bcd89.js"><link rel="prefetch" href="/assets/js/32.edf4b652.js"><link rel="prefetch" href="/assets/js/33.9a8a64e2.js"><link rel="prefetch" href="/assets/js/34.bc4d5632.js"><link rel="prefetch" href="/assets/js/35.014211ce.js"><link rel="prefetch" href="/assets/js/36.68da29a2.js"><link rel="prefetch" href="/assets/js/37.3a956f74.js"><link rel="prefetch" href="/assets/js/38.8efd5066.js"><link rel="prefetch" href="/assets/js/39.73528062.js"><link rel="prefetch" href="/assets/js/40.43e2e807.js"><link rel="prefetch" href="/assets/js/41.a8f2873a.js"><link rel="prefetch" href="/assets/js/42.2978ae2a.js"><link rel="prefetch" href="/assets/js/43.bf27c1e6.js"><link rel="prefetch" href="/assets/js/44.b0ed6d80.js"><link rel="prefetch" href="/assets/js/45.312ee373.js"><link rel="prefetch" href="/assets/js/46.39210f0c.js"><link rel="prefetch" href="/assets/js/47.0f87069c.js"><link rel="prefetch" href="/assets/js/48.a6f9409c.js"><link rel="prefetch" href="/assets/js/49.70f42589.js"><link rel="prefetch" href="/assets/js/5.c5d1e422.js"><link rel="prefetch" href="/assets/js/50.ffc18222.js"><link rel="prefetch" href="/assets/js/52.af1adf7d.js"><link rel="prefetch" href="/assets/js/53.641a804e.js"><link rel="prefetch" href="/assets/js/54.2c6c36bc.js"><link rel="prefetch" href="/assets/js/6.aeeb0e13.js"><link rel="prefetch" href="/assets/js/7.ce3ee154.js"><link rel="prefetch" href="/assets/js/9.57f04676.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.02b45572.js"><link rel="prefetch" href="/assets/js/vendors~notification.a9caabb0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.29ddec2e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/metamask-fox.svg" alt="MetaMask Docs" class="logo"> <span class="site-name can-hide">MetaMask Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div> <a href="https://github.com/MetaMask/metamask-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div> <a href="https://github.com/MetaMask/metamask-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/guide/getting-started.html" class="sidebar-link">Getting Started</a></li><li><a href="/guide/common-terms.html" class="sidebar-link">Common Terms</a></li><li><a href="/guide/initializing-dapps.html" class="sidebar-link">Initializing Dapps</a></li><li><a href="/guide/accessing-accounts.html" class="sidebar-link">Accessing Accounts</a></li><li><a href="/guide/sending-transactions.html" class="sidebar-link">Sending Transactions</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>API Reference</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/ethereum-provider.html" class="sidebar-link">Ethereum Provider API</a></li><li><a href="/guide/provider-migration.html" class="sidebar-link">Provider Migration Guide</a></li><li><a href="/guide/rpc-api.html" class="sidebar-link">RPC API</a></li><li><a href="/guide/signing-data.html" class="sidebar-link">Signing Data</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Best Practices</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/registering-function-names.html" class="sidebar-link">Registering Your Contract's Method Names</a></li><li><a href="/guide/registering-your-token.html" class="sidebar-link">Registering Tokens with Users</a></li><li><a href="/guide/defining-your-icon.html" class="sidebar-link">Defining Your App's Icon</a></li><li><a href="/guide/onboarding-library.html" class="sidebar-link">Onboarding Library</a></li><li><a href="/guide/metamask-extension-provider.html" class="sidebar-link">MetaMask Extension Provider</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Mobile</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/mobile-getting-started.html" class="sidebar-link">Introduction</a></li><li><a href="/guide/site-compatibility-checklist.html" class="sidebar-link">Site Compatibility Checklist</a></li><li><a href="/guide/mobile-best-practices.html" class="sidebar-link">Best Practices</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>MetaMask SDK (Beta)</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/metamask-sdk-intro.html" class="sidebar-link">Welcome</a></li><li><a href="/guide/metamask-sdk-concepts.html" class="sidebar-link">Concepts</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/metamask-sdk-js/" class="sidebar-heading clickable"><span>Javascript</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/metamask-sdk-js/metamask-sdk-react.html" class="sidebar-link">React</a></li><li><a href="/guide/metamask-sdk-js/metamask-sdk-react-native.html" class="sidebar-link">React Native</a></li><li><a href="/guide/metamask-sdk-js/metamask-sdk-other-frameworks.html" class="sidebar-link">Other web frameworks</a></li><li><a href="/guide/metamask-sdk-js/metamask-sdk-pure-javascript.html" class="sidebar-link">Pure javascript</a></li><li><a href="/guide/metamask-sdk-js/metamask-sdk-nodejs.html" class="sidebar-link">NodeJS</a></li><li><a href="/guide/metamask-sdk-js/metamask-sdk-electron.html" class="sidebar-link">Electron</a></li><li><a href="/guide/metamask-sdk-js/metamask-sdk-js-options.html" class="sidebar-link">Options</a></li></ul></section></li><li><a href="/guide/metamask-sdk-mobile.html" class="sidebar-link">Mobile apps</a></li><li><a href="/guide/metamask-sdk-gaming.html" class="sidebar-link">Gaming</a></li><li><a href="/guide/metamask-sdk-known-issues-future-work.html" class="sidebar-link">Known Issues &amp; Future Work</a></li><li><a href="/guide/metamask-sdk-support.html" class="sidebar-link">Support</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Snaps</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/snaps.html" class="sidebar-link">Introduction</a></li><li><a href="/guide/snaps-development-guide.html" class="sidebar-link">Development Guide</a></li><li><a href="/guide/snaps-rpc-api.html" class="sidebar-link">JSON-RPC API</a></li><li><a href="/guide/snaps-patching-dependencies.html" aria-current="page" class="active sidebar-link">Patching Dependencies</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/snaps-patching-dependencies.html#patching-the-use-of-xmlhttprequest" class="sidebar-link">Patching the use of XMLHttpRequest</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Resources</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/create-dapp.html" class="sidebar-link">Create A Simple Dapp</a></li><li><a href="/guide/contributors.html" class="sidebar-link">Contributors</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="patching-dependencies"><a href="#patching-dependencies" class="header-anchor">#</a> Patching Dependencies</h1> <div class="custom-block tip"><p class="custom-block-title">Only Available in MetaMask Flask</p> <p><a href="/guide/snaps.html">Snaps</a> is only available in <a href="https://metamask.io/flask" target="_blank" rel="noopener noreferrer">MetaMask Flask<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <p>A problem that may arise as you develop your snap is that some dependencies make use of APIs that aren't available in the snaps execution environment. To work around this, we firstly recommend that you check if another library is available that makes use of the APIs made available for snaps (see <a href="/guide/snaps-development-guide.html#the-snap-execution-environment">Snaps Development Guide</a> for a list of APIs).</p> <p>If you are unable to find another library (or version) that works with the snaps execution environment, another way of solving the problem is by patching the dependency yourself. For this we can leverage <a href="https://npmjs.com/package/patch-package" target="_blank" rel="noopener noreferrer"><code>patch-package</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p><code>patch-package</code> works by allowing you to make changes to your dependencies, saving the changes as a patch and replaying it when installing dependencies.</p> <p>To use it, install it using the following command:</p> <p><code>yarn add -D patch-package postinstall-postinstall</code>.</p> <p>Then add a postinstall script to your <code>package.json</code>.</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">&quot;scripts&quot;: {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  &quot;postinstall&quot;: &quot;patch-package&quot;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">}
</span></span></code></pre></div><p>Now you can make changes to your dependencies inside <code>node_modules</code> and run <code>yarn patch-package package-name</code> to save the changes as a patch. This will create a <code>.patch</code> file containing your dependency patch. These patches can be committed to your Git repository and will be replayed when you re-install your dependencies.</p> <p><strong>If you need guidance in how you can patch your dependencies or otherwise need help troubleshooting dependency problems, please create an issue on the <a href="https://github.com/MetaMask/snaps-skunkworks" target="_blank" rel="noopener noreferrer">MetaMask/snaps-skunkworks<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> repository.</strong></p> <h2 id="patching-the-use-of-xmlhttprequest"><a href="#patching-the-use-of-xmlhttprequest" class="header-anchor">#</a> Patching the use of XMLHttpRequest</h2> <p>The <code>XMLHttpRequest</code> API is not exposed in the snaps execution environment and will not be in the future. Because of this, you may run into issues with dependencies in your dependency tree attempting to leverage this API for their network requests.</p> <p>Below we've included some examples of popular libraries that use <code>XMLHttpRequest</code> and are therefore not compatible with the snaps execution environment. Below you'll also find some patching strategies for fixing dependencies that try to make use of these libraries.</p> <h3 id="cross-fetch"><a href="#cross-fetch" class="header-anchor">#</a> cross-fetch</h3> <p><code>cross-fetch</code> is a popular library used for cross-platform access to the <code>fetch</code> API across multiple environments. Under the hood, however, the library does make use of <code>XMLHttpRequest</code> and therefore it will cause issues when used in a snap.</p> <p>Luckily, this issue is fairly easy to patch with <code>patch-package</code>. To do this, open up <code>node_modules/cross-fetch/browser-ponyfill.js</code> and find the following lines (it's close to the bottom):</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Choose between native implementation (global) or custom implementation (__self__)</span>
<span class="token comment">// var ctx = global.fetch ? global : __self__;</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> __self__<span class="token punctuation">;</span> <span class="token comment">// this line disable service worker support temporarily</span>
</code></pre></div><p>You can replace that with the following snippet:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Choose between native implementation (global) or custom implementation (__self__)</span>
<span class="token keyword">var</span> ctx <span class="token operator">=</span> global<span class="token punctuation">.</span>fetch
  <span class="token operator">?</span> <span class="token punctuation">{</span> <span class="token operator">...</span>global<span class="token punctuation">,</span> <span class="token literal-property property">fetch</span><span class="token operator">:</span> global<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>global<span class="token punctuation">)</span> <span class="token punctuation">}</span>
  <span class="token operator">:</span> __self__<span class="token punctuation">;</span>
<span class="token comment">// var ctx = __self__; // this line disable service worker support temporarily</span>
</code></pre></div><p>After replacing it, run <code>yarn patch-package cross-fetch</code> which saves the patch for future use.</p> <p>If you find that it's easier you can also use the following patch, copy and paste this to <code>patches/cross-fetch+3.1.5.patch</code> and re-install your dependencies.</p> <div class="language-diff extra-class"><pre class="language-diff"><code>diff --git a/node_modules/cross-fetch/dist/browser-ponyfill.js b/node_modules/cross-fetch/dist/browser-ponyfill.js
index f216aa3..6b3263b 100644
<span class="token coord">--- a/node_modules/cross-fetch/dist/browser-ponyfill.js</span>
<span class="token coord">+++ b/node_modules/cross-fetch/dist/browser-ponyfill.js</span>
@@ -543,8 +543,8 @@ __self__.fetch.ponyfill = true;
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">// Remove &quot;polyfill&quot; property added by whatwg-fetch
</span><span class="token prefix unchanged"> </span><span class="token line">delete __self__.fetch.polyfill;
</span><span class="token prefix unchanged"> </span><span class="token line">// Choose between native implementation (global) or custom implementation (__self__)
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">// var ctx = global.fetch ? global : __self__;
</span><span class="token prefix deleted">-</span><span class="token line">var ctx = __self__; // this line disable service worker support temporarily
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">var ctx = global.fetch ? { ...global, fetch: global.fetch.bind(global) } : __self__;
</span><span class="token prefix inserted">+</span><span class="token line">// var ctx = __self__; // this line disable service worker support temporarily
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">exports = ctx.fetch // To enable: import fetch from 'cross-fetch'
</span><span class="token prefix unchanged"> </span><span class="token line">exports.default = ctx.fetch // For TypeScript consumers without esModuleInterop.
</span><span class="token prefix unchanged"> </span><span class="token line">exports.fetch = ctx.fetch // To enable: import {fetch} from 'cross-fetch'
</span></span></code></pre></div><p>Using either of these methods allows your dependencies to access the <code>fetch</code> API correctly and <code>cross-fetch</code> compatible with the snaps execution environment.</p> <h3 id="axios"><a href="#axios" class="header-anchor">#</a> axios</h3> <p><code>axios</code> is another popular networking library that leverages <code>XMLHttpRequest</code> under the hood.</p> <p>At the time of writing there is no known way of patching <code>axios</code> to work with the snaps execution environment. Instead you may have to resort to replacing the usage of <code>axios</code> with another library such as <code>isomorphic-fetch</code> or <code>isomorphic-unfetch</code>. Or simply using the snaps execution environment global <code>fetch</code>.</p> <p>Below is a small example of how you can rewrite your dependency to use <code>fetch</code> instead of <code>axios</code>.
<strong>Note</strong>: In a production environment this may be a large task depending on the usage of <code>axios</code>.</p> <p><strong>axios</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> instance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">baseURL</span><span class="token operator">:</span> <span class="token string">'https://api.github.com/'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance
  <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'users/MetaMask'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>status <span class="token operator">&gt;=</span> <span class="token number">400</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Bad response from server'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>fetch</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://api.github.com/users/MetaMask'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>res<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Bad response from server'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">json</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>More resources:</p> <ul><li><a href="https://kentcdodds.com/blog/replace-axios-with-a-simple-custom-fetch-wrapper" target="_blank" rel="noopener noreferrer">Replace axios with a simple custom fetch wrapper<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/MetaMask/metamask-docs/edit/master/docs/guide/snaps-patching-dependencies.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/5/2022, 6:08:04 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/snaps-rpc-api.html" class="prev">
        JSON-RPC API
      </a></span> <span class="next"><a href="/guide/create-dapp.html">
        Create A Simple Dapp
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.4586a63c.js" defer></script><script src="/assets/js/4.7d26e848.js" defer></script><script src="/assets/js/51.4cd0339e.js" defer></script><script src="/assets/js/8.29467d76.js" defer></script>
  </body>
</html>
